(function(){"use strict";var e={6890:function(e,t,i){var s=i(538),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("DisplayMain")],1)},o=[],a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("HomeHeader"),i("router-view"),i("HomeFooter")],1)},r=[],l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[i("el-menu-item",{attrs:{index:"0"}},[i("router-link",{attrs:{to:"/"}},[e._v("首页")])],1),i("el-menu-item",{attrs:{index:"1"}},[e._v(" 村落自动分类 ")]),i("el-menu-item",{attrs:{index:"2"}},[i("router-link",{attrs:{to:"/autoSortingPage"}},[e._v("营建显著性点位发掘")])],1),i("el-menu-item",{attrs:{index:"3"}},[e._v(" 村落宜居区域发掘 ")]),i("el-menu-item",{attrs:{index:"4"}},[e._v(" 村落营建基因发掘 ")]),i("el-menu-item",{attrs:{index:"5"}},[i("router-link",{attrs:{to:"/wyPage"}},[e._v("山形可视化")])],1)],1)],1)},c=[],m={name:"HomeHeader",data(){return{activeIndex:"0"}},methods:{handleSelect(e,t){console.log(e,t)}}},u=m,d=i(1001),h=(0,d.Z)(u,l,c,!1,null,null,null),p=h.exports,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div")},v=[],f={},y=f,x=(0,d.Z)(y,g,v,!1,null,null,null),P=x.exports,_={name:"DisplayMain",components:{HomeHeader:p,HomeFooter:P}},w=_,b=(0,d.Z)(w,a,r,!1,null,null,null),C=b.exports,$={name:"app",components:{DisplayMain:C}},S=$,A=(0,d.Z)(S,n,o,!1,null,null,null),L=A.exports,k=i(8345),N=i(4720),E=i.n(N);s["default"].use(E());var D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-container",[i("BandSide"),i("el-main",[i("div",{staticClass:"center"},[i("CesiumDemo")],1)])],1)],1)},I=[],T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-aside",{staticClass:"aside",attrs:{width:"110px"}},[i("img",{staticStyle:{margin:"5px 1px 0px 1px"},attrs:{src:e.clickPic,width:"80px"}}),i("div",[i("h4",{staticStyle:{margin:"0px 1px 0px 1px"}},[e._v("请上传数据")]),e.canSee?i("i",{staticClass:"el-icon-loading"}):e._e(),e.canSee?i("h1",[e._v("处理中...")]):e._e(),i("UploadFiles"),i("AccessAblityCalculate"),i("AscensionPointGenerate"),i("ExposivePointGenerate")],1)])],1)},F=[],U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{multiple:"",action:"#",limit:2,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-change":e.handleChange,"http-request":e.selectFiles,"on-exceed":e.handleExceed,"file-list":e.fileList,"auto-upload":!1}},[i("el-button",{staticClass:"buttonSelect",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),i("el-button",{staticClass:"uploadButton",attrs:{size:"small",type:"success"},on:{"~click":function(t){return e.submitUpload.apply(null,arguments)}}},[e._v("上传文件")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)},O=[],M=i(9669),R=i.n(M),Z={name:"UploadFiles",data(){return{canSee:!1,fileList:[],fileData:"",activeIndex:"2",loadPage:{}}},methods:{selectFiles(e){this.fileData.append("files",e.file)},handleChange(e,t){let i=t.slice(0,t.length-1).find((t=>t.name===e.name));i&&(this.$message.error("当前文件已经存在!"),t.pop()),this.fileList=t},handleRemove(e,t){this.fileList=t,this.$store.state.imgUrls={}},handleExceed(e,t){this.$message.warning("当前限制选择 2 个文件")},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},submitUpload(){this.fileList.length<2?this.$message({message:"请先选择2个文件",type:"warning"}):(console.log("here"),this.fileData=new FormData,this.$refs.upload.submit(),this.fileData.append("loginToken",this.loginToken),this.loadPage=this.$loading({lock:!0,text:"处理中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.canSee=!0,R().post("/uploadFiles",this.fileData).then((e=>{0===e.data.result.code?(this.$message({message:"上传成功",type:"success"}),this.$store.commit("modifyImageUrls",[e.data.result.dem_url,2]),this.$store.commit("modifyImageUrls",[e.data.result.remote_url,1]),this.$store.commit("modifyCenterCoord",e.data.result.centerCoord),""!=e.data.result.dem_url&&this.$store.state.pageFunction()):this.$message({message:"上传失败",type:"error"}),this.loadPage.close(),this.canSee=!1})).catch((e=>{console.log(e)})))}}},z=Z,B=(0,d.Z)(z,U,O,!1,null,null,null),G=B.exports,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h4",{staticStyle:{margin:"0px 1px 0px 1px"}},[e._v("计算可达域")]),i("el-select",{attrs:{placeholder:"步行时间",size:"small"},on:{change:e.catTimeLimit},model:{value:e.time_limit,callback:function(t){e.time_limit=t},expression:"time_limit"}},e._l(e.options1,(function(e){return i("el-option",{key:e.time_limit,attrs:{label:e.label,value:e.time_limit}})})),1),i("el-input",{attrs:{placeholder:"dem精度",size:"small",clearable:""},model:{value:e.demAxis,callback:function(t){e.demAxis=t},expression:"demAxis"}}),i("el-button",{staticStyle:{"margin-left":"0px",width:"100px"},attrs:{size:"small",type:"success"},on:{click:e.distantCalc}},[e._v("可达域计算")])],1)},j=[],H={name:"AccessAblityCalculate",data(){return{canSee:!1,loadPage:{},options1:[{time_limit:"15",label:"15min"},{time_limit:"30",label:"30min"},{time_limit:"45",label:"45min"},{time_limit:"60",label:"60min"}],demAxis:""}},methods:{catTimeLimit(e){this.$store.commit("modifyTimeLimit",e),console.log("选择的value为："+this.time_limit)},distantCalc(){this.loadPage=this.$loading({lock:!0,text:"处理中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.canSee=!0,R().post("/distantCalc",{time_limit:this.$store.getters.getTimeLimit,demAxis:this.demAxis}).then((e=>{0===e.data.result.code?(this.$message({message:"计算成功",type:"success"}),this.$store.commit("modifyCenterPoint",e.data.result.centerpoint),this.$store.commit("modifyAccessDomain",e.data.result.accessdomain_path),this.$store.commit("modifyVillageLocation",e.data.result.location),""!=e.data.result.accessdomain_path&&this.$store.state.accessDomainFunction()):this.$message({message:"计算失败",type:"error"}),this.loadPage.close(),this.canSee=!1}))}}},W=H,q=(0,d.Z)(W,V,j,!1,null,null,null),J=q.exports,X=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h4",{staticStyle:{margin:"0px 1px 0px 1px"}},[e._v("计算登临点")]),i("el-select",{attrs:{placeholder:"登临点数量",size:"small"},on:{change:e.catAscensionPointNum},model:{value:e.ascensionPointNum,callback:function(t){e.ascensionPointNum=t},expression:"ascensionPointNum"}},e._l(e.options2,(function(e){return i("el-option",{key:e.ascensionPointNum,attrs:{label:e.label,value:e.ascensionPointNum}})})),1),i("el-input",{attrs:{placeholder:"计算间隔",size:"small",clearable:""},model:{value:e.divideSpace,callback:function(t){e.divideSpace=t},expression:"divideSpace"}}),i("el-button",{staticStyle:{"margin-left":"0px",width:"100px"},attrs:{size:"small",type:"success"},on:{click:e.calAscensionPoint}},[e._v("计算登临点 ")])],1)},K=[],Q={name:"AscensionPointGenereate",data(){return{canSee:!1,loadPage:{},options2:[{ascensionPointNum:"1",label:"1"},{ascensionPointNum:"5",label:"5"},{ascensionPointNum:"10",label:"10"}],divideSpace:""}},methods:{catAscensionPointNum(e){this.$store.commit("modifyAscensionPointNum",e),console.log("登临点数量："+e)},calAscensionPoint(){this.loadPage=this.$loading({lock:!0,text:"处理中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),R().post("/calAscensionPoint",{ascensionPointNum:this.$store.getters.getAscensionPointNum,divideSpace:this.divideSpace}).then((e=>{if(0===e.data.result.code){this.$message({message:"计算成功",type:"success"});var t=e.data.result.ascension_point_list,i=e.data.result.ascensionpoint_viewshedpathlist;this.$store.commit("modifyAscensionPointCoords",t),this.$store.commit("modifyViewShedUrl",i),""!=t&&this.$store.state.ascensionPointFunction()}else this.$message({message:"计算失败",type:"error"});this.loadPage.close()}))}}},Y=Q,ee=(0,d.Z)(Y,X,K,!1,null,null,null),te=ee.exports,ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h4",{staticStyle:{margin:"0px 1px 0px 1px"}},[e._v("计算暴露点")]),i("el-select",{attrs:{placeholder:"暴露点数量",size:"small"},on:{change:e.catExposivePointNum},model:{value:e.exposivePointNum,callback:function(t){e.exposivePointNum=t},expression:"exposivePointNum"}},e._l(e.options2,(function(e){return i("el-option",{key:e.exposivePointNum,attrs:{label:e.label,value:e.exposivePointNum}})})),1),i("el-button",{staticStyle:{"margin-left":"0px",width:"100px"},attrs:{size:"small",type:"success"},on:{click:e.calExposivePoint}},[e._v("计算暴露点 ")])],1)},se=[],ne={name:"ExposivePointGenerate",data(){return{canSee:!1,loadPage:{},options2:[{exposivePointNum:"1",label:"1"},{exposivePointNum:"5",label:"5"},{exposivePointNum:"10",label:"10"}]}},methods:{catExposivePointNum(e){this.$store.commit("modifyExposivePointNum",e),console.log("暴露点数量："+e)},calExposivePoint(){this.loadPage=this.$loading({lock:!0,text:"处理中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.canSee=!0,R().post("/calExposivePoint",{exposivePointNum:this.$store.getters.getExposivePointNum}).then((e=>{if(0===e.data.result.code){this.$message({message:"计算成功",type:"success"});var t=e.data.result.exposivepoint_numlist_absolute;this.$store.commit("modifyExposivePointCoords",t),""!=t&&this.$store.state.exposivePointFunction()}else this.$message({message:"计算失败",type:"error"});this.loadPage.close(),this.canSee=!1}))}}},oe=ne,ae=(0,d.Z)(oe,ie,se,!1,null,null,null),re=ae.exports,le={name:"BandSide",data(){return{clickPic:i(714)}},methods:{},components:{UploadFiles:G,AccessAblityCalculate:J,AscensionPointGenerate:te,ExposivePointGenerate:re}},ce=le,me=(0,d.Z)(ce,T,F,!1,null,null,null),ue=me.exports,de=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"cesiumContainer"}})},he=[],pe=i(5450),ge={name:"CesiumDemo",data(){return{viewer:null,accesspointsLayer:null,viewshedpointsLayer:null}},mounted(){this.cesiumInit(),this.configInit(),this.terrainSerivce(),this.imageService(),this.$store.commit("setPageFunction",this.viewerFly),this.$store.commit("setAccessDomain",this.addAccessPointsLayer),this.$store.commit("setAscensionPoint",this.showAscensionPoints),this.$store.commit("setExposivePoint",this.showExposivePoints)},methods:{cesiumInit(){pe.f3v.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmODE5ZmVkOS0zMzNkLTRhZDItYmE1NS1iOWU5MjA4ZDYwNzgiLCJpZCI6NjA3MzQsImlhdCI6MTYyNTQwNjc2M30.AhvFT18WWD0biep1Le_7RHXRwBXrtQb6U2ihTnhH1nM",this.viewer=new pe.AEx("cesiumContainer")},configInit(){this.viewer.animation._container.style.display="none",this.viewer.timeline.container.style.display="none",this.viewer.fullscreenButton.container.style.display="none",this.viewer.geocoder.container.style.display="none",this.viewer.homeButton.container.style.display="none",this.viewer.navigationHelpButton.container.style.display="none",this.viewer.sceneModePicker.container.style.display="none",this.viewer.baseLayerPicker.container.style.display="none",this.viewer._cesiumWidget._creditContainer.style.display="none"},terrainSerivce(){var e=new pe.DX$({url:pe.CdF.fromAssetId(1),requestVertexNormals:!1,isShowGlobe:!0});this.viewer.terrainProvider=e},imageService(){var e=new pe.PdK({url:"http://t0.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles",layer:"tiandituImg",style:"default",format:"image/jpeg",tileMatrixSetID:"tiandituImg",show:!0,maximumLevel:18});this.viewer.imageryProvider=e},addAccessPointsLayer(){var e=this.viewer.scene.imageryLayers,t=this.$store.getters.getVillageLocation;let i=new pe.AeJ.fromDegrees(t[0],t[1],t[2],t[3]);null==this.accesspointsLayer||e.remove(this.accesspointsLayer,!0),this.accesspointsLayer=e.addImageryProvider(new pe.BFO({url:this.$store.getters.getAccessDomain,rectangle:i})),this.accesspointsLayer.alpha=.2,this.accesspointsLayer.brightness=1.5;var s=this.$store.getters.getCenterPoint[0],n=this.$store.getters.getCenterPoint[1];this.viewer.entities.add({position:pe.b91.fromDegrees(s,n),point:{show:!0,color:pe.Ilk.BLUE,pixelSize:6,outlineColor:pe.Ilk.BLACK,outlineWidth:1,heightReference:pe.MDq.CLAMP_TO_GROUND}})},viewerFly(){this.viewer.scene.camera.flyTo({destination:pe.b91.fromDegrees(this.$store.state.centerCoord[0],this.$store.state.centerCoord[1],3e3),duration:4,orientation:{heading:pe.ZX$.toRadians(-10),pitch:pe.ZX$.toRadians(-90)}})},showAccessPoints(){var e=null;e=this.viewer.scene.primitives.add(new pe.XVf);const t=this.$store.getters.getCoords;for(var i=0;i<t.length;i++){var s=pe.b91.fromDegrees(t[i][0][0],t[i][0][1],t[i][1]);e.add({pixelSize:6,color:pe.Ilk.BLUE,outlineColor:pe.Ilk.BLACK,outlineWidth:1,position:s,heightReference:pe.MDq.CLAMP_TO_GROUND})}},showAscensionPoints(){const e=this.$store.getters.getCoords;for(var t=0;t<e.length;t++){var i=this.$store.getters.getCoords[t][0],s=this.$store.getters.getCoords[t][1];this.viewer.entities.add({position:pe.b91.fromDegrees(i,s),point:{show:!0,color:pe.Ilk.RED,pixelSize:6,outlineColor:pe.Ilk.BLACK,outlineWidth:1,heightReference:pe.MDq.CLAMP_TO_GROUND}})}var n=this.viewer.scene.imageryLayers,o=this.$store.getters.getVillageLocation;let a=new pe.AeJ.fromDegrees(o[0],o[1],o[2],o[3]);var r=new pe.SjE(this.viewer.canvas),l=this.$store.getters.getViewShed;r.setInputAction((()=>{null==this.viewshedpointsLayer?(n.remove(this.accesspointsLayer,!0),this.viewshedpointsLayer=n.addImageryProvider(new pe.BFO({url:l[0],rectangle:a}))):(n.remove(this.viewshedpointsLayer,!0),this.viewshedpointsLayer=n.addImageryProvider(new pe.BFO({url:this.$store.getters.getViewShed,rectangle:a}))),this.viewshedpointsLayer.alpha=.2,this.viewshedpointsLayer.brightness=1.5}),pe.Wvr.LEFT_CLICK)},showExposivePoints(){const e=this.$store.getters.getCoords;for(var t=0;t<e.length;t++){var i=this.$store.getters.getCoords[t][0],s=this.$store.getters.getCoords[t][1];this.viewer.entities.add({position:pe.b91.fromDegrees(i,s),point:{show:!0,color:pe.Ilk.GREEN,pixelSize:6,outlineColor:pe.Ilk.BLACK,outlineWidth:1,heightReference:pe.MDq.CLAMP_TO_GROUND}})}}}},ve=ge,fe=(0,d.Z)(ve,de,he,!1,null,null,null),ye=fe.exports,xe={name:"AutoSortingPage",data(){return{showrowdemo:!1}},components:{BandSide:ue,CesiumDemo:ye}},Pe=xe,_e=(0,d.Z)(Pe,D,I,!1,null,null,null),we=_e.exports,be=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-main",[i("div",[i("h1",{staticClass:"textCenter"},[e._v("传统村落绿色宜居营建基因挖掘系统")]),i("p",{staticClass:"textCenter"},[e._v("Author")]),i("div",{staticClass:"imgCenter"},[i("img",{attrs:{src:e.imgSrc}})])])])],1)},Ce=[],$e={name:"HomeMain",data(){return{imgSrc:i(8151)}}},Se=$e,Ae=(0,d.Z)(Se,be,Ce,!1,null,null,null),Le=Ae.exports,ke=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Ne=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h1",[e._v("Test")])])}],Ee={},De=Ee,Ie=(0,d.Z)(De,ke,Ne,!1,null,null,null),Te=Ie.exports,Fe=new k.Z({routes:[{path:"/",component:Le},{path:"/autoSortingPage",component:we},{path:"/wyPage",component:Te}]}),Ue=i(629);s["default"].use(Ue.ZP);const Oe={},Me={modifyImageUrls(e,t){e.imgUrls["imageUrl"+t[1].toString()]=t[0].toString()},modifyCenterCoord(e,t){e.centerCoord=t},setPageFunction(e,t){e.pageFunction=t},modifyTimeLimit(e,t){e.time_limit=t},modifyCenterPoint(e,t){e.centerpoint=t},modifyAccessDomain(e,t){e.accessdomain_path=t},setAccessDomain(e,t){e.accessDomainFunction=t},modifyAscensionPointNum(e,t){e.ascensionPointNum=t},modifyVillageLocation(e,t){e.location=t},modifyAscensionPointCoords(e,t){e.coords=t},setAscensionPoint(e,t){e.ascensionPointFunction=t},modifyViewShedUrl(e,t){e.viewshedUrls=t},modifyExposivePointNum(e,t){e.exposivePointNum=t},modifyExposivePointCoords(e,t){e.coords=t},setExposivePoint(e,t){e.exposivePointFunction=t}},Re={space:"",imgUrls:{imageUrl1:"",imageUrl2:""},accessdomain_path:"",centerCoord:{},centerpoint:{},coords:{},time_limit:0,ascensionPointNum:0,exposivePointNum:0,location:{},viewshedUrls:{},pageFunction:{},accessDomainFunction:{},ascensionPointFunction:{},exposivePointFunction:{}},Ze={getImgUrls(e){return e.imgUrls},getCoords(e){return e.coords},getTimeLimit(e){return e.time_limit},getAccessDomain(e){return e.accessdomain_path},getCenterPoint(e){return e.centerpoint},getAscensionPointNum(e){return e.ascensionPointNum},getViewShed(e){return e.viewshedUrls},getExposivePointNum(e){return e.exposivePointNum},getVillageLocation(e){return e.location}};var ze=new Ue.ZP.Store({actions:Oe,mutations:Me,state:Re,getters:Ze});s["default"].config.productionTip=!1,s["default"].use(k.Z),new s["default"]({render:e=>e(L),router:Fe,store:ze}).$mount("#app")},8151:function(e,t,i){e.exports=i.p+"static/img/QMC.48576ca4.png"},714:function(e,t,i){e.exports=i.p+"static/img/click.cae6261b.png"}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,s,n,o){if(!s){var a=1/0;for(m=0;m<e.length;m++){s=e[m][0],n=e[m][1],o=e[m][2];for(var r=!0,l=0;l<s.length;l++)(!1&o||a>=o)&&Object.keys(i.O).every((function(e){return i.O[e](s[l])}))?s.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(m--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var m=e.length;m>0&&e[m-1][2]>o;m--)e[m]=e[m-1];e[m]=[s,n,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p=""}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,a=s[0],r=s[1],l=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var m=l(i)}for(t&&t(s);c<a.length;c++)o=a[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(m)},s=self["webpackChunkvue_cesium_dev"]=self["webpackChunkvue_cesium_dev"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(6890)}));s=i.O(s)})();
//# sourceMappingURL=app.be160064.js.map